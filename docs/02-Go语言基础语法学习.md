# 📚 Go 语言基础语法学习

本章将介绍实现猜数字游戏所需的 Go 语言基础语法知识。

## 1. 包（Package）和导入（Import）

### 包的概念
Go 语言中的每个文件都属于一个包，`main` 包是程序的入口点。

```go
package main  // 声明包名

import (
    "fmt"        // 格式化 I/O
    "math/rand"  // 随机数生成
    "time"       // 时间操作
)
```

### 导入方式
```go
// 单个导入
import "fmt"

// 批量导入（推荐）
import (
    "fmt"
    "math/rand"
    "strconv"
)

// 别名导入
import f "fmt"

// 匿名导入（仅执行包的 init 函数）
import _ "math/rand"
```

## 2. 变量声明和类型

### 基本类型
```go
// 整数类型
var age int = 25
var score int32 = 100

// 浮点类型
var price float64 = 99.99

// 字符串类型
var name string = "Go Game"

// 布尔类型
var isWin bool = true
```

### 变量声明方式
```go
// 方式1：完整声明
var targetNumber int = 50

// 方式2：类型推断
var targetNumber = 50

// 方式3：短变量声明（仅在函数内部）
targetNumber := 50

// 方式4：批量声明
var (
    attempts int
    isGameOver bool
    playerName string
)
```

### 常量声明
```go
const (
    MinNumber = 1
    MaxNumber = 100
    GameTitle = "猜数字游戏"
)
```

## 3. 函数定义和调用

### 基本函数语法
```go
// 无参数无返回值
func sayHello() {
    fmt.Println("Hello!")
}

// 有参数有返回值
func add(a int, b int) int {
    return a + b
}

// 参数类型相同时的简写
func multiply(a, b int) int {
    return a * b
}

// 多返回值
func divide(a, b int) (int, error) {
    if b == 0 {
        return 0, fmt.Errorf("除数不能为零")
    }
    return a / b, nil
}

// 命名返回值
func calculate(a, b int) (sum, product int) {
    sum = a + b
    product = a * b
    return  // 自动返回命名的变量
}
```

### 函数作为值
```go
// 函数类型变量
var operation func(int, int) int

operation = add
result := operation(3, 4)  // result = 7
```

## 4. 控制流语句

### if 条件语句
```go
// 基本 if 语句
if guess == targetNumber {
    fmt.Println("猜对了！")
}

// if-else 语句
if guess > targetNumber {
    fmt.Println("太大了！")
} else if guess < targetNumber {
    fmt.Println("太小了！")
} else {
    fmt.Println("猜对了！")
}

// if 语句中的初始化
if num, err := strconv.Atoi(input); err == nil {
    fmt.Printf("转换成功：%d\n", num)
}
```

### for 循环语句
```go
// 传统 for 循环
for i := 0; i < 10; i++ {
    fmt.Println(i)
}

// while 风格的 for 循环
attempts := 0
for attempts < 10 {
    attempts++
    // 游戏逻辑
}

// 无限循环
for {
    // 游戏主循环
    if gameOver {
        break
    }
}

// 遍历切片或数组
numbers := []int{1, 2, 3, 4, 5}
for index, value := range numbers {
    fmt.Printf("索引：%d，值：%d\n", index, value)
}

// 仅需要值，忽略索引
for _, value := range numbers {
    fmt.Println(value)
}
```

### switch 语句
```go
// 基本 switch
switch input {
case "y", "yes", "是":
    return true
case "n", "no", "否":
    return false
default:
    fmt.Println("无效输入")
}

// 无表达式的 switch（相当于 if-else 链）
switch {
case guess > targetNumber:
    fmt.Println("太大了！")
case guess < targetNumber:
    fmt.Println("太小了！")
default:
    fmt.Println("猜对了！")
}
```

## 5. 错误处理

### 错误类型
```go
// 创建错误
err := fmt.Errorf("数字必须在 %d-%d 之间", MinNumber, MaxNumber)

// 检查错误
if err != nil {
    fmt.Printf("发生错误：%v\n", err)
    return
}
```

### 错误处理模式
```go
func getPlayerInput() (int, error) {
    var input string
    fmt.Print("请输入数字：")
    
    // 读取输入
    _, err := fmt.Scanln(&input)
    if err != nil {
        return 0, fmt.Errorf("读取输入失败：%v", err)
    }
    
    // 转换为数字
    number, err := strconv.Atoi(input)
    if err != nil {
        return 0, fmt.Errorf("输入不是有效数字：%v", err)
    }
    
    // 验证范围
    if number < 1 || number > 100 {
        return 0, fmt.Errorf("数字必须在 1-100 之间")
    }
    
    return number, nil
}

// 使用示例
func main() {
    number, err := getPlayerInput()
    if err != nil {
        fmt.Printf("输入错误：%v\n", err)
        return
    }
    
    fmt.Printf("您输入的数字是：%d\n", number)
}
```

## 6. 字符串处理

### 常用字符串操作
```go
import "strings"

// 字符串拼接
greeting := "欢迎来到" + "猜数字游戏"

// 格式化字符串
message := fmt.Sprintf("您猜了 %d 次", attempts)

// 字符串处理
input := "  Hello World  "
trimmed := strings.TrimSpace(input)      // 去除首尾空格
lower := strings.ToLower(input)          // 转小写
upper := strings.ToUpper(input)          // 转大写
contains := strings.Contains(input, "Hello")  // 检查包含

// 字符串分割和连接
parts := strings.Split("a,b,c", ",")     // ["a", "b", "c"]
joined := strings.Join(parts, "-")       // "a-b-c"

// 字符串重复
separator := strings.Repeat("=", 50)     // 50个等号
```

## 7. 类型转换

### 基本类型转换
```go
// 字符串转数字
str := "123"
num, err := strconv.Atoi(str)
if err != nil {
    fmt.Printf("转换失败：%v\n", err)
}

// 数字转字符串
number := 456
str = strconv.Itoa(number)

// 其他转换
floatNum, err := strconv.ParseFloat("3.14", 64)
boolVal, err := strconv.ParseBool("true")
```

## 8. 实践练习

### 练习1：基本输入输出
```go
package main

import "fmt"

func main() {
    var name string
    var age int
    
    fmt.Print("请输入您的姓名：")
    fmt.Scanln(&name)
    
    fmt.Print("请输入您的年龄：")
    fmt.Scanln(&age)
    
    fmt.Printf("您好，%s！您今年 %d 岁。\n", name, age)
}
```

### 练习2：简单的数字验证
```go
package main

import (
    "fmt"
    "strconv"
)

func validateNumber(input string) (int, error) {
    // 转换为数字
    num, err := strconv.Atoi(input)
    if err != nil {
        return 0, fmt.Errorf("输入不是有效数字")
    }
    
    // 验证范围
    if num < 1 || num > 100 {
        return 0, fmt.Errorf("数字必须在 1-100 之间")
    }
    
    return num, nil
}

func main() {
    testInputs := []string{"50", "abc", "150", "-5", "25"}
    
    for _, input := range testInputs {
        if num, err := validateNumber(input); err != nil {
            fmt.Printf("输入 '%s' 验证失败：%v\n", input, err)
        } else {
            fmt.Printf("输入 '%s' 验证成功：%d\n", input, num)
        }
    }
}
```

## 小结

本章介绍了实现猜数字游戏所需的 Go 语言基础语法：

- **包和导入**：组织代码结构
- **变量和类型**：存储游戏数据
- **函数**：封装游戏逻辑
- **控制流**：实现游戏流程
- **错误处理**：提高程序健壮性
- **字符串处理**：处理用户输入
- **类型转换**：数据格式转换

掌握这些基础知识后，我们就可以开始设计游戏的核心数据结构了。

## 下一步

继续学习：[03-核心数据结构设计.md](./03-核心数据结构设计.md)

在下一章中，我们将学习如何使用结构体来设计游戏的核心数据结构。
